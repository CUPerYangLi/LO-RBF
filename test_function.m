%% ²âÊÔº¯Êý¿â
function test_function
global test dfdx1 dfdxx1 dfdx2 dfdxx2
func=1;
%rbf = @(epsilon,r) exp(-(epsilon*r).^2);     % Gaussian RBF
if func==1
    test=@(x1,x2) 2.*cos(10.*x1).*sin(10.*x2)+sin(10.*x1.*x2);
    dfdx1=@(x1,x2) 10.*x2*cos(10.*x1.*x2) - 20.*sin(10.*x1)*sin(10.*x2);
    dfdxx1=@(x1,x2) -200*cos(10*x1).*sin(10*x2) - 100*x2.^2.*sin(10*x1*x2);
    dfdx2=@(x1,x2) 10.*x1.*cos(10.*x1.*x2) + 20.*cos(10.*x1)*cos(10.*x2);
    dfdxx2=@(x1,x2) -200*cos(10*x1).*sin(10*x2) - 100*x1.^2.*sin(10*x1*x2);
elseif func==2
    test=@(x1,x2) (tanh(9.*x2-9.*x1)+1)/9;
    dfdx1=@(x1,x2) tanh(9*x1 - 9*x2)^2 - 1;
    dfdxx1=@(x1,x2) -2*tanh(9*x1 - 9*x2)*(9*tanh(9*x1 - 9*x2)^2 - 9);
    dfdx2=@(x1,x2) 1 - tanh(9*x1 - 9*x2)^2;
    dfdxx2=@(x1,x2) -2*tanh(9*x1 - 9*x2)*(9*tanh(9*x1 - 9*x2)^2 - 9);
elseif func==3
    test=@(x1,x2) (1.25+cos(5.4.*x2))/(6.*(1+(3.*x1-1)^2));
    dfdx1=@(x1,x2) -((108*x1 - 36)*(cos((27*x2)/5) + 5/4))/(6*(3*x1 - 1)^2 + 6)^2;
    dfdxx1=@(x1,x2) (2*(108*x1 - 36)^2*(cos((27*x2)/5) + 5/4))/(6*(3*x1 - 1)^2 + 6)^3 - (108*(cos((27*x2)/5) + 5/4))/(6*(3*x1 - 1)^2 + 6)^2;
    dfdx2=@(x1,x2) -(27*sin((27*x2)/5))/(5*(6*(3*x1 - 1)^2 + 6));
    dfdxx2=@(x1,x2) -(729*cos((27*x2)/5))/(25*(6*(3*x1 - 1)^2 + 6));
elseif func==4
    test=@(x1,x2) 0.75*exp(-((9.*x1-2)^2+(9.*x2-2)^2)/4)+0.75*exp(-(9.*x1+1)^2/49-(9.*x2+1)/10)+0.5*exp(-((9.*x1-7)^2+(9.*x2-3)^2)/4)-0.2*exp(-(9.*x1-4)^2-(9.*x2-7)^2);
    dfdx1=@(x1,x2) (exp(- (9*x1 - 4)^2 - (9*x2 - 7)^2)*(162*x1 - 72))/5 - (3*exp(- (9*x1 - 2)^2/4 - (9*x2 - 2)^2/4)*((81*x1)/2 - 9))/4 - (exp(- (9*x2 - 3)^2/4 - (9*x1 - 7)^2/4)*((81*x1)/2 - 63/2))/2 - (3*exp(- (9*x2)/10 - (9*x1 + 1)^2/49 - 1/10)*((162*x1)/49 + 18/49))/4;
    dfdxx1=@(x1,x2) (162*exp(- (9*x1 - 4)^2 - (9*x2 - 7)^2))/5 - (243*exp(- (9*x2)/10 - (9*x1 + 1)^2/49 - 1/10))/98 - (243*exp(- (9*x1 - 2)^2/4 - (9*x2 - 2)^2/4))/8 - (81*exp(- (9*x2 - 3)^2/4 - (9*x1 - 7)^2/4))/4 + (3*exp(- (9*x2)/10 - (9*x1 + 1)^2/49 - 1/10)*((162*x1)/49 + 18/49)^2)/4 + (3*exp(- (9*x1 - 2)^2/4 - (9*x2 - 2)^2/4)*((81*x1)/2 - 9)^2)/4 + (exp(- (9*x2 - 3)^2/4 - (9*x1 - 7)^2/4)*((81*x1)/2 - 63/2)^2)/2 - (exp(- (9*x1 - 4)^2 - (9*x2 - 7)^2)*(162*x1 - 72)^2)/5;
    dfdx2=@(x1,x2) (exp(- (9*x1 - 4)^2 - (9*x2 - 7)^2)*(162*x2 - 126))/5 - (3*exp(- (9*x1 - 2)^2/4 - (9*x2 - 2)^2/4)*((81*x2)/2 - 9))/4 - (exp(- (9*x2 - 3)^2/4 - (9*x1 - 7)^2/4)*((81*x2)/2 - 27/2))/2 - (27*exp(- (9*x2)/10 - (9*x1 + 1)^2/49 - 1/10))/40;
    dfdxx2=@(x1,x2) (243*exp(- (9*x2)/10 - (9*x1 + 1)^2/49 - 1/10))/400 + (162*exp(- (9*x1 - 4)^2 - (9*x2 - 7)^2))/5 - (243*exp(- (9*x1 - 2)^2/4 - (9*x2 - 2)^2/4))/8 - (81*exp(- (9*x2 - 3)^2/4 - (9*x1 - 7)^2/4))/4 + (3*exp(- (9*x1 - 2)^2/4 - (9*x2 - 2)^2/4)*((81*x2)/2 - 9)^2)/4 + (exp(- (9*x2 - 3)^2/4 - (9*x1 - 7)^2/4)*((81*x2)/2 - 27/2)^2)/2 - (exp(- (9*x1 - 4)^2 - (9*x2 - 7)^2)*(162*x2 - 126)^2)/5;
elseif func==5
    test=@(x1,x2) exp(-81./16*((x1-0.5)^2+(x2-0.5)^2))/3;
    dfdx1=@(x1,x2) -(exp(- (81*(x1 - 1/2)^2)/16 - (81*(x2 - 1/2)^2)/16)*((81*x1)/8 - 81/16))/3;
    dfdxx1=@(x1,x2) (exp(- (81*(x1 - 1/2)^2)/16 - (81*(x2 - 1/2)^2)/16)*((81*x1)/8 - 81/16)^2)/3 - (27*exp(- (81*(x1 - 1/2)^2)/16 - (81*(x2 - 1/2)^2)/16))/8;
    dfdx2=@(x1,x2) -(exp(- (81*(x1 - 1/2)^2)/16 - (81*(x2 - 1/2)^2)/16)*((81*x2)/8 - 81/16))/3;
    dfdxx2=@(x1,x2) (exp(- (81*(x1 - 1/2)^2)/16 - (81*(x2 - 1/2)^2)/16)*((81*x2)/8 - 81/16)^2)/3 - (27*exp(- (81*(x1 - 1/2)^2)/16 - (81*(x2 - 1/2)^2)/16))/8;
elseif func==6
    test=@(x1,x2) exp(-81./4*((x1-0.5)^2+(x2-0.5)^2))/3;
    dfdx1=@(x1,x2) -(exp(- (81*(x1 - 1/2)^2)/4 - (81*(x2 - 1/2)^2)/4)*((81*x1)/2 - 81/4))/3;
    dfdxx1=@(x1,x2) (exp(- (81*(x1 - 1/2)^2)/4 - (81*(x2 - 1/2)^2)/4)*((81*x1)/2 - 81/4)^2)/3 - (27*exp(- (81*(x1 - 1/2)^2)/4 - (81*(x2 - 1/2)^2)/4))/2;
    dfdx2=@(x1,x2) -(exp(- (81*(x1 - 1/2)^2)/4 - (81*(x2 - 1/2)^2)/4)*((81*x2)/2 - 81/4))/3;
    dfdxx2=@(x1,x2) (exp(- (81*(x1 - 1/2)^2)/4 - (81*(x2 - 1/2)^2)/4)*((81*x2)/2 - 81/4)^2)/3 - (27*exp(- (81*(x1 - 1/2)^2)/4 - (81*(x2 - 1/2)^2)/4))/2;
elseif func==7
    test=@(x1,x2) sqrt(64-81.*((x1-0.5)^2+(x2-0.5)^2))/9-0.5;
    dfdx1=@(x1,x2) -(162*x1 - 81)/(18*(64 - 81*(x2 - 1/2)^2 - 81*(x1 - 1/2)^2)^(1/2));
    dfdxx1=@(x1,x2) - (162*x1 - 81)^2/(36*(64 - 81*(x2 - 1/2)^2 - 81*(x1 - 1/2)^2)^(3/2)) - 9/(64 - 81*(x2 - 1/2)^2 - 81*(x1 - 1/2)^2)^(1/2);
    dfdx2=@(x1,x2) -(162*x2 - 81)/(18*(64 - 81*(x2 - 1/2)^2 - 81*(x1 - 1/2)^2)^(1/2));
    dfdxx2=@(x1,x2) - (162*x2 - 81)^2/(36*(64 - 81*(x2 - 1/2)^2 - 81*(x1 - 1/2)^2)^(3/2)) - 9/(64 - 81*(x2 - 1/2)^2 - 81*(x1 - 1/2)^2)^(1/2);
elseif func==8
    test=@(x1,x2) tanh(-3.*(0.595576*(x2+3.79762)^2-x1-10))+1;
    dfdx1=@(x1,x2) 3 - 3*tanh(3*x1 - (16093415110024863*(x2 + 2137870002111843/562949953421312)^2)/9007199254740992 + 30)^2;
    dfdxx1=@(x1,x2) 6*tanh(3*x1 - (16093415110024863*(x2 + 2137870002111843/562949953421312)^2)/9007199254740992 + 30)*(3*tanh(3*x1 - (16093415110024863*(x2 + 2137870002111843/562949953421312)^2)/9007199254740992 + 30)^2 - 3);
    dfdx2=@(x1,x2) ((16093415110024863*x2)/4503599627370496 + 34405629395255619908010236752509/2535301200456458802993406410752)*(tanh(3*x1 - (16093415110024863*(x2 + 2137870002111843/562949953421312)^2)/9007199254740992 + 30)^2 - 1);
    dfdxx2=@(x1,x2) (16093415110024863*tanh(3*x1 - (16093415110024863*(x2 + 2137870002111843/562949953421312)^2)/9007199254740992 + 30)^2)/4503599627370496 + 2*tanh(3*x1 - (16093415110024863*(x2 + 2137870002111843/562949953421312)^2)/9007199254740992 + 30)*((16093415110024863*x2)/4503599627370496 + 34405629395255619908010236752509/2535301200456458802993406410752)^2*(tanh(3*x1 - (16093415110024863*(x2 + 2137870002111843/562949953421312)^2)/9007199254740992 + 30)^2 - 1) - 16093415110024863/4503599627370496;
elseif func==9
    test=@(x1,x2) (1-x1./2)^6*(1-x2./2)^6+1000.*(1-x1)^3*x1^3*(1-x2)^3*x2^3+x2^6*(1-x1./2)^6+x1^6*(1-x2./2)^6;
    dfdx1=@(x1,x2) 3*(x1/2 - 1)^5*(x2/2 - 1)^6 + 6*x1^5*(x2/2 - 1)^6 + 3*x2^6*(x1/2 - 1)^5 + 3000*x1^2*x2^3*(x1 - 1)^3*(x2 - 1)^3 + 3000*x1^3*x2^3*(x1 - 1)^2*(x2 - 1)^3;
    dfdxx1=@(x1,x2) (15*(x1/2 - 1)^4*(x2/2 - 1)^6)/2 + 30*x1^4*(x2/2 - 1)^6 + (15*x2^6*(x1/2 - 1)^4)/2 + 6000*x1*x2^3*(x1 - 1)^3*(x2 - 1)^3 + 3000*x1^3*x2^3*(2*x1 - 2)*(x2 - 1)^3 + 18000*x1^2*x2^3*(x1 - 1)^2*(x2 - 1)^3;
    dfdx2=@(x1,x2) 3*(x1/2 - 1)^6*(x2/2 - 1)^5 + 3*x1^6*(x2/2 - 1)^5 + 6*x2^5*(x1/2 - 1)^6 + 3000*x1^3*x2^2*(x1 - 1)^3*(x2 - 1)^3 + 3000*x1^3*x2^3*(x1 - 1)^3*(x2 - 1)^2;
    dfdxx2=@(x1,x2) (15*(x1/2 - 1)^6*(x2/2 - 1)^4)/2 + 30*x2^4*(x1/2 - 1)^6 + (15*x1^6*(x2/2 - 1)^4)/2 + 6000*x1^3*x2*(x1 - 1)^3*(x2 - 1)^3 + 3000*x1^3*x2^3*(2*x2 - 2)*(x1 - 1)^3 + 18000*x1^3*x2^2*(x1 - 1)^3*(x2 - 1)^2;
end
        